<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DONSOCIAL</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="./styles.css" />

    <!-- Performance: adelanta conexi√≥n con el Pixel -->
    <link rel="preconnect" href="https://connect.facebook.net" crossorigin />
    <link rel="dns-prefetch" href="//connect.facebook.net" />

    <!-- Performance: precarga imagen de fondo del hero (cambi√° el href si tu archivo es otro) -->
    <link rel="preload" as="image" href="imagenes/fondo.avif" type="image/avif" fetchpriority="high" />

    <!-- Meta Pixel Code (con coincidencias avanzadas manuales) -->
<script>
  // Utilidades
  function getQS(name){ const u=new URLSearchParams(location.search); return u.get(name)||null }
  function normEmail(v){ return (v||"").trim().toLowerCase() }
  function normPhone(v){
    // deja solo d√≠gitos; si es AR agrega 54 si faltara
    let p=(v||"").replace(/\D+/g,"");
    if(p && p.length===10) p="54"+p; // opcional, ajust√° a tu necesidad
    return p;
  }
  function getOrCreateExternalId(){
    const k="external_id";
    let id=localStorage.getItem(k);
    if(!id){
      id=(crypto && crypto.randomUUID) ? crypto.randomUUID() : (Date.now()+"-"+Math.random().toString(16).slice(2));
      localStorage.setItem(k,id);
    }
    return id;
  }

  // Datos de usuario disponibles (querystring o localStorage)
  const userEmail  = normEmail( getQS("em") || localStorage.getItem("em") || "" );
  const userPhone  = normPhone( getQS("ph") || localStorage.getItem("ph") || "" );
  const externalId = getOrCreateExternalId();

  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');

  // ‚¨áÔ∏è ACTIV√ÅS COINCIDENCIAS AVANZADAS AC√Å (tercer par√°metro)
  fbq('init', '1459000075661483', {
    external_id: externalId,        // siempre
    em: userEmail || undefined,     // opcional si ten√©s email
    ph: userPhone || undefined,     // opcional si ten√©s tel√©fono
    country: 'AR'                   // opcional
  });

  fbq('track', 'PageView');
</script>
<noscript>
  <img height="1" width="1" style="display:none"
       src="https://www.facebook.com/tr?id=1459000075661483&ev=PageView&noscript=1"/>
</noscript>
<!-- End Meta Pixel Code -->
    
  </head>

  <body>
    <div class="container background-image">
      <div class="overlay"></div>
      <div class="content">
        <!-- Logo PNG -->
        <img src="imagenes/logo.png" class="logo" width="240" height="120"
             alt="DON SOCIAL" decoding="async" fetchpriority="high" />

        <p class="title">Envianos un WhatsApp<br />para crear tu cuenta</p>

        <a class="whatsapp-button" id="whatsappButton">
          <span>¬°Contact√° ya!</span>
          <img src="imagenes/whatsapp.png" alt="whatsapp"
               class="whatsapp-icon" width="24" height="24" decoding="async" loading="lazy" />
        </a>

        <p class="subtitle">S√≠n L√≠mite de retiro<br />S√≠n Cronogramas<br />Gan√°s y cobr√°s a cualquier hora</p>
        <p class="description">-RED OFICIAL: DON SOCIAL 32-</p>
      </div>
    </div>

    <!-- Script WhatsApp con utm_campaign -> "Prefijo-UTM" -->
    <script>
      // === Configur√° tu prefijo ac√° ===
      const LANDING_PREFIX = "CH1.0"; // Cambi√° si quer√©s otro prefijo

      // Lee un par√°metro de la URL (?utm_campaign=...)
      function getQueryParam(name) {
        const params = new URLSearchParams(window.location.search);
        const v = params.get(name);
        return v ? decodeURIComponent(v) : null;
      }

      // Normaliza la UTM para el c√≥digo (sin espacios/s√≠mbolos raros)
      function normalizeUtm(v) {
        return String(v || "")
          .trim()
          .replace(/\s+/g, "_")          // espacios -> _
          .replace(/[^A-Za-z0-9_-]/g, "") // quita s√≠mbolos raros
          || "ORG";
      }

      // Persistimos utm_campaign si viene en la URL
      (function persistUTM() {
        const utmFromUrl = getQueryParam("utm_campaign");
        if (utmFromUrl) {
          localStorage.setItem("utm_campaign", utmFromUrl);
        }
      })();

      // Obtiene utm_campaign (URL > localStorage > "ORGANICO")
      function getUTMCampaign() {
        return getQueryParam("utm_campaign") || localStorage.getItem("utm_campaign") || "ORG";
      }

      document.getElementById("whatsappButton").addEventListener("click", function () {
        
      const numeros = ["5493516768842"];
        
      const telefono = numeros[Math.floor(Math.random() * numeros.length)];
    
      const utm = normalizeUtm(getUTMCampaign());
      const codigo = `${LANDING_PREFIX}-${utm}`;
    
      const variantes = [
        `¬°Hola! Vi este anuncio, ¬øme pas√°s info? ${codigo}`,
        `Hola! Vi el anuncio, ¬øpod√©s darme m√°s info? ${codigo}`,
        `Buenas! Me cont√°s un poco m√°s del anuncio? ${codigo}`,
        `Hola! Quisiera saber m√°s sobre lo que ofrecen. ${codigo}`,
        `Buenas! ¬øMe das m√°s detalles, por favor? ${codigo}`,
        `Hola! Estoy interesado, ¬øc√≥mo funciona? ${codigo}`,
        `Hola! Vi tu publicaci√≥n, ¬øpodr√≠as ampliarme la info? ${codigo}`,
        `Buenas! ¬øMe podr√≠as pasar informaci√≥n? ${codigo}`,
        `Hola! Estoy viendo el anuncio, ¬øme das m√°s datos? ${codigo}`,
        `Buenas! Me interesa, ¬øpodr√≠as contarme m√°s? ${codigo}`,
        `Hola! ¬øC√≥mo hago para empezar? ${codigo}`,
        `Buenas! ¬øMe compart√≠s info para sumarme? ${codigo}`,
        `Hola! ¬øTen√©s m√°s detalles del anuncio? ${codigo}`,
        `Buenas! Quiero m√°s info, gracias. ${codigo}`,
        `Hola! Me interesa, ¬øme explic√°s un poco? ${codigo}`,
        `Buenas! ¬øQu√© pasos tengo que seguir? ${codigo}`,
        `Hola! Vi el aviso, ¬øme das info? ${codigo}`,
        `Buenas! Estoy interesado/a, ¬øme pas√°s detalles? ${codigo}`,
        `Hola! ¬øMe cont√°s de qu√© se trata? ${codigo}`,
        `Buenas! Quiero saber m√°s, ¬øme ayud√°s? ${codigo}`
      ];
    
      const mensaje = variantes[Math.floor(Math.random() * variantes.length)];
      const link = `https://wa.me/${telefono}?text=${encodeURIComponent(mensaje)}`;
    
      // üîµ Evento est√°ndar "Contact"
      if (typeof fbq === "function") {
        fbq('track', 'Contact', {
          content_name: 'CTA WhatsApp',
          content_category: 'LeadGen',
          utm_campaign: utm,
          code: codigo
        });
      }

    
      // Abrir WhatsApp (con mini delay para que el evento llegue)
      setTimeout(() => {
        window.open(link, "_blank", "noopener");
      }, 150);
    });

    </script>
  </body>
</html>
